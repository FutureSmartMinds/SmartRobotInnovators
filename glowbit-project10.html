<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>(10) Miaâ€™s GlowBit ChatBot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Same required script order -->
  <script src="lib/blockly_compressed.js"></script>
  <script src="lib/blocks_compressed.js"></script>
  <script src="lib/javascript_compressed.js"></script>
  <script src="lib/msg/en.js"></script>
  <script src="assets/global.js"></script>
  <script src="lib/blockly_xml_patch.js"></script>

  <style>
    .gb-wrapper{max-width:1100px;margin:0 auto;font-family:"Segoe UI",Roboto,Arial,sans-serif;}
    .gb-header{text-align:center;background:#fef2f2;color:#be123c;font-size:22px;font-weight:800;
               padding:10px 12px;border-radius:12px;margin:8px 0 6px;box-shadow:0 1px 4px rgba(0,0,0,0.08);}
    .gb-subhead{text-align:center;background:#fff7ed;color:#c2410c;font-size:16px;font-weight:700;
                padding:8px 12px;border-radius:10px;margin:0 0 10px;box-shadow:0 1px 3px rgba(0,0,0,0.06);}
    .callout{background:#f1f5f9;border-left:6px solid #64748b;padding:10px 12px;border-radius:10px;color:#0f172a;margin:8px 0;}
    .tip{display:inline-block;background:#fde68a;color:#92400e;border:1px solid #f59e0b;border-radius:6px;padding:2px 6px;font-size:12px;font-weight:800;}
    .nav-btns{display:flex;justify-content:space-between;gap:8px;margin-top:10px;flex-wrap:wrap;}
    .gb-btn{padding:8px 14px;border:none;border-radius:8px;font-weight:700;cursor:pointer;flex:1;text-align:center;}
    .gb-btn.next{background:#00A1D6;color:#fff;}
    .gb-btn.back{background:#6B7280;color:#fff;}
    .gb-btn.cta{background:#16a34a;color:#fff;margin-top:8px;}
    .character-frame{text-align:center;margin-top:18px;}
    .character-frame img{width:85%;max-width:260px;height:auto;border-radius:12px;
                         box-shadow:0 4px 12px rgba(0,0,0,0.25);object-fit:cover;}
    #glowbit-project10-editor{height:560px;min-height:560px;background:#fff;}

    /* Compact Check-Your-Setup modal */
    #solutionModalP10{display:none;position:fixed;top:60px;right:20px;width:640px;max-width:42%;
      background:#fff;border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,0.28);
      z-index:12000;overflow:hidden;user-select:none;}
    #solutionHeaderP10{cursor:move;padding:10px 12px;background:#be123c;color:#fff;font-weight:700;
      text-align:left;border-radius:10px 10px 0 0;display:flex;justify-content:space-between;align-items:center;}
    #solutionWorkspaceP10{height:360px;width:100%;border-top:1px solid #eee;background:#fafafa;}
    #solutionFooterP10{text-align:center;padding:12px;background:#fff;}
    #solutionFooterP10 button{background:#be123c;color:#fff;border:none;border-radius:8px;
      padding:8px 18px;cursor:pointer;font-weight:700;}
    @media(max-width:900px){
      #solutionModalP10{left:10px;right:10px;width:auto;max-width:calc(100% - 20px);top:40px;}
      #solutionWorkspaceP10{height:260px;}
    }
  </style>
</head>

<body>
  <div class="gb-wrapper">
    <div class="gb-header">(10) Miaâ€™s GlowBit ChatBot</div>
    <div class="gb-subhead">
      Letâ€™s make GlowBit welcome you! Youâ€™ll code GlowBit to display a welcome message, count from 1 to 10, and play a name tune â€” like a smart chatbot.
    </div>

    <div id="glowbit-project10"></div>
  </div>

  <!-- âœ… Compact Solution Modal -->
  <div id="solutionModalP10" aria-hidden="true" role="dialog">
    <div id="solutionHeaderP10">
      <div>âœ… Correct Setup â€” ChatBot</div>
      <button id="solutionCloseP10" title="Close">âœ•</button>
    </div>
    <div id="solutionWorkspaceP10" aria-label="Correct solution workspace"></div>
    <div id="solutionFooterP10"><button id="solutionCloseBtnP10">Close</button></div>
  </div>

  <script>
  (function boot(){
    if(!(window.Glowbit && window.Blockly)) return setTimeout(boot,120);

    /* Create standard two-column UI */
    const lesson = Glowbit.createLessonUI('glowbit-project10', {
      title:'',instructions:'',pixelSize:28,
      defaultJson:{blocks:{languageVersion:0,blocks:[]}}
    });
    if(lesson && lesson.workspace) lesson.workspace.clear();

    /* Helper for pause-show-clear */
    function seqPauseShowClear(ms=500,text){
      return {
        type:"pause_block",fields:{MS:ms},
        next:{block:{type:"show_text",fields:{TEXT:text||"Hello"},
        next:{block:{type:"clear_screen"}}}}
      };
    }

    /* âœ… Correct Setup JSON */
    const solutionJson = {
      blocks:{languageVersion:0,blocks:[
        {type:"on_start",x:20,y:20,
          inputs:{DO:{block:{type:"show_text",fields:{TEXT:"Welcome!"},next:{
            block:{type:"show_number",inputs:{NUM:{shadow:{type:"math_number",fields:{NUM:1}}}},
            next:{block:{type:"clear_screen"}}}}}}}},
        {type:"on_button_pressed",fields:{BTN:"A"},x:20,y:160,
          inputs:{DO:{block:{type:"show_number",
          inputs:{NUM:{shadow:{type:"math_number",fields:{NUM:1}}}}}}}},
        {type:"on_button_pressed",fields:{BTN:"B"},x:20,y:300,
          inputs:{DO:{block:{type:"play_tone_note",
          fields:{NOTE:"C4",BEATS:"0.5"}}}}}
      ]}
    };
    window.solutionJson = solutionJson;

    /* Sidebar steps â€” same style as Projects 8 & 9 */
    const stepCards = [

`<h3 style="text-align:center;color:#be123c;">Step 1 â€” Show a Welcome Message</h3>
<div class="callout">
  1ï¸âƒ£ ğŸ§° Go to the <strong>Basic</strong> tab and drag a <strong>show string</strong> block to the Workspace. Type <em>Welcome!</em> in the text field.<br>
  2ï¸âƒ£ ğŸš€ Drag an <strong>on start</strong> block and place <em>show string Welcome!</em> inside it.<br>
  3ï¸âƒ£ â–¶ï¸ Click the green <strong>Play</strong> button to see the message on the LED grid.<br>
  ğŸ’¬ Mia: â€œGlowBit says hi!â€<br><br>
  4ï¸âƒ£ ğŸ§¹ Remove the block from <em>on start</em> after testing.
</div>`,

`<h3 style="text-align:center;color:#be123c;">Step 2 â€” Show a Number</h3>
<div class="callout">
  1ï¸âƒ£ ğŸ§° From the <strong>Basic</strong> tab, drag a <strong>show number</strong> block to the Workspace and set it to <code>1</code>.<br>
  2ï¸âƒ£ ğŸš€ Place it inside an <strong>on start</strong> block.<br>
  3ï¸âƒ£ â–¶ï¸ Press <strong>Play</strong> â€” GlowBit shows â€œ1.â€<br>
  ğŸ’¬ Mia: â€œGlowBitâ€™s counting!â€<br><br>
  4ï¸âƒ£ ğŸ§¹ Remove it from <em>on start</em> after testing.
</div>`,

`<h3 style="text-align:center;color:#be123c;">Step 3 â€” Add Button Inputs</h3>
<div class="callout">
  1ï¸âƒ£ ğŸ”˜ From <strong>Input</strong>, drag <strong>on button A pressed</strong> and place the <em>show number 1</em> block inside it.<br>
  2ï¸âƒ£ ğŸ”˜ From <strong>Input</strong>, drag <strong>on button B pressed</strong>.<br>
  3ï¸âƒ£ ğŸµ From <strong>Music</strong>, drag <strong>play tone</strong> â†’ choose <em>Middle C</em> for <em>Â½ beat</em>.<br>
  ğŸ’¬ Mia: â€œGlowBit will play a tune!â€<br><br>
  â–¶ï¸ Click <strong>Play</strong>, press A to see the number, B to hear the tone.
</div>`,

`<h3 style="text-align:center;color:#be123c;">Step 4 â€” Add Counting on Button A</h3>
<div class="callout">
  1ï¸âƒ£ ğŸ”¢ From <strong>Variables</strong>, click <strong>Make a Variable</strong> â†’ name it <em>Count</em>.<br>
  2ï¸âƒ£ ğŸš€ From <strong>Basic</strong>, drag <strong>on start</strong> â†’ add <strong>set Count to 1</strong>.<br>
  3ï¸âƒ£ ğŸ”˜ Add <strong>on button A pressed</strong> and inside it place an <strong>if then else</strong> block from <strong>Logic</strong>.<br>
  4ï¸âƒ£ âš™ï¸ Set the condition to <code>Count &lt; 10</code> (drag Count + â€œ&lt;â€ from Logic + math number 10).<br>
  5ï¸âƒ£ â• In <em>then</em> area: add <strong>change Count by 1</strong> and <strong>show number Count</strong>.<br>
  6ï¸âƒ£ ğŸ” In <em>else</em>: add <strong>set Count to 1</strong> and <strong>show number 1</strong>.<br>
  â–¶ï¸ Click <strong>Play</strong>, press A repeatedly to count 1-10, then cycle back to 1.<br>
  ğŸ’¬ Mia: â€œGlowBit counts with me!â€
</div>`,

`<div class="callout" style="text-align:center;">
  <button class="gb-btn cta" id="open-solution">âœ… Check Your Setup</button>
</div>`,

`<h3 style="text-align:center;color:#00A1D6;">Did You Know?</h3>
<div class="callout">
  â€¢ ğŸ¤– Chatbots like Alexa and Siri respond with voices and animations â€” our GlowBit ChatBot shows text and numbers the same way!<br>
  â€¢ ğŸ”¢ Smart devices use counters to track steps or messages; our variable â€œCountâ€ acts the same way.<br>
  â€¢ ğŸµ Music and text combine in robot greetings to make interactions fun and friendly â€” just like GlowBit does here.
</div>
<div class="callout">
  <span class="tip">Try this</span> Change the tone for Button B and add a second note to make a short â€œname tune.â€
</div>`
    ];

    /* Pagination (same as P8/P9) */
    function paginate(){
      const sidebar=document.querySelector('#glowbit-project10 .glowbit-left');
      if(!sidebar)return;
      const editor=document.getElementById('glowbit-project10-editor');
      const targetH=(editor&&editor.offsetHeight)?editor.offsetHeight:520;

      const meas=document.createElement('div');
      meas.style.visibility='hidden';meas.style.position='absolute';meas.style.left='-9999px';
      meas.style.width=(sidebar.clientWidth||320)+'px';document.body.appendChild(meas);

      const pages=[];let current=[];const reserve=56;
      stepCards.forEach(html=>{
        const c=document.createElement('div');c.innerHTML=html;meas.appendChild(c);
        const tooTall=meas.scrollHeight>(targetH-reserve);
        if(tooTall){
          if(current.length===0){pages.push([html]);meas.innerHTML='';}
          else{pages.push([...current]);current=[html];meas.innerHTML='';
            current.forEach(h=>{const d=document.createElement('div');d.innerHTML=h;meas.appendChild(d);});}
        }else current.push(html);
      });
      if(current.length)pages.push(current);
      document.body.removeChild(meas);

      function render(i){
        sidebar.innerHTML=pages[i].join('');
        const nav=document.createElement('div');nav.className='nav-btns';
        if(i>0){const b=document.createElement('button');b.textContent='â¬… Back';b.className='gb-btn back';b.onclick=()=>render(i-1);nav.appendChild(b);}
        if(i<pages.length-1){const n=document.createElement('button');n.textContent='Next âœ';n.className='gb-btn next';n.onclick=()=>render(i+1);nav.appendChild(n);}
        sidebar.appendChild(nav);
        const frame=document.createElement('div');frame.className='character-frame';
        frame.innerHTML='<img src="images/GlowBit3.png" alt="GlowBit buddy">';sidebar.appendChild(frame);
        const openBtn=document.getElementById('open-solution');
        if(openBtn)openBtn.addEventListener('click',()=>showSolutionModal());
      }
      render(0);
    }
    paginate();
    window.addEventListener('resize',()=>{paginate();if(lesson&&lesson.workspace)Blockly.svgResize(lesson.workspace);});

    /* Modal behavior */
    const modal=document.getElementById('solutionModalP10');
    const wsDiv=document.getElementById('solutionWorkspaceP10');
    const closeBtns=[document.getElementById('solutionCloseP10'),document.getElementById('solutionCloseBtnP10')];
    function showSolutionModal(){
      modal.style.display='block';wsDiv.innerHTML='';
      const ws=Blockly.inject(wsDiv,{readOnly:true,scrollbars:true});
      Blockly.serialization.workspaces.load(window.solutionJson,ws);
    }
    closeBtns.forEach(b=>b.addEventListener('click',()=>modal.style.display='none'));

    console.log('âœ… Project 10 â€“ ChatBot ready: sidebar, pagination, compact modal.');
  })();
  </script>
</body>
</html>
