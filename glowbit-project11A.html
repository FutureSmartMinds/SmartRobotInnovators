<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>(11A) Liam‚Äôs GlowBit Visual Guessing Challenge</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Blockly + Global -->
  <script src="lib/blockly_compressed.js"></script>
  <script src="lib/blocks_compressed.js"></script>
  <script src="lib/javascript_compressed.js"></script>
  <script src="lib/msg/en.js"></script>
  <script src="assets/global.js"></script>
  <script src="lib/blockly_xml_patch.js"></script>

  <style>
    .gb-wrapper{max-width:1100px;margin:0 auto;font-family:"Segoe UI",Roboto,Arial,sans-serif;}
    .gb-header{text-align:center;background:#e0f2fe;color:#1e3a8a;font-size:22px;font-weight:800;
      padding:10px 12px;border-radius:12px;margin:8px 0 6px;box-shadow:0 1px 4px rgba(0,0,0,0.08);}
    .gb-subhead{text-align:center;background:#f0f9ff;color:#0369a1;font-size:20px;font-weight:700;
      padding:10px 16px;border-radius:10px;margin:0 0 10px;box-shadow:0 1px 3px rgba(0,0,0,0.06);}
    .callout{background:#f1f5f9;border-left:6px solid #64748b;padding:10px 12px;border-radius:10px;
      color:#0f172a;margin:8px 0;}
    .tip{display:inline-block;background:#fde68a;color:#92400e;border:1px solid #f59e0b;border-radius:6px;
      padding:2px 6px;font-size:12px;font-weight:800;}
    .nav-btns{display:flex;justify-content:space-between;gap:8px;margin-top:10px;flex-wrap:wrap;}
    .gb-btn{padding:8px 14px;border:none;border-radius:8px;font-weight:700;cursor:pointer;flex:1;text-align:center;}
    .gb-btn.next{background:#00A1D6;color:#fff;}
    .gb-btn.back{background:#6B7280;color:#fff;}
    .gb-btn.cta{background:#16a34a;color:#fff;margin-top:8px;}
    .character-frame{text-align:center;margin-top:18px;}
    .character-frame img{width:85%;max-width:260px;height:auto;border-radius:12px;
      box-shadow:0 4px 12px rgba(0,0,0,0.25);}
    #glowbit-project11A-editor{height:560px;min-height:560px;background:#fff;}
    #solutionModalP11A{display:none;position:fixed;top:60px;right:20px;width:640px;max-width:42%;
      background:#fff;border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,0.28);z-index:12000;overflow:hidden;}
    #solutionHeaderP11A{cursor:move;padding:10px 12px;background:#1e3a8a;color:#fff;font-weight:700;
      text-align:left;border-radius:10px 10px 0 0;display:flex;justify-content:space-between;align-items:center;}
    #solutionWorkspaceP11A{height:360px;width:100%;border-top:1px solid #eee;background:#fafafa;}
    #solutionFooterP11A{text-align:center;padding:12px;background:#fff;}
    #solutionFooterP11A button{background:#1e3a8a;color:#fff;border:none;border-radius:8px;
      padding:8px 18px;cursor:pointer;font-weight:700;}
    @media(max-width:900px){
      #solutionModalP11A{left:10px;right:10px;width:auto;max-width:calc(100% - 20px);top:40px;}
      #solutionWorkspaceP11A{height:260px;}
    }
  </style>
</head>

<body>
  <div class="gb-wrapper">
    <div class="gb-header">(11A) Liam‚Äôs GlowBit Visual Guessing Challenge</div>
    <div class="gb-subhead">
      Liam loves coding games with dazzling lights! üí°<br>
      ‚ÄúMy version lights up the screen with patterns based on your Guess.<br>
      Can you master my visual challenge? Let‚Äôs code together and create some light magic!‚Äù
    </div>

    <div id="glowbit-project11A"></div>
  </div>

  <!-- ‚úÖ Compact Solution Modal -->
  <div id="solutionModalP11A" aria-hidden="true" role="dialog">
    <div id="solutionHeaderP11A">
      <div>‚úÖ Correct Setup ‚Äî Liam‚Äôs Visual Challenge</div>
      <button id="solutionCloseP11A" title="Close">‚úï</button>
    </div>
    <div id="solutionWorkspaceP11A" aria-label="Correct solution workspace"></div>
    <div id="solutionFooterP11A"><button id="solutionCloseBtnP11A">Close</button></div>
  </div>

  <script>
  (function boot(){
    if(!(window.Glowbit && window.Blockly)) return setTimeout(boot,120);

    const lesson=Glowbit.createLessonUI('glowbit-project11A',{
      title:'',instructions:'',pixelSize:28,
      defaultJson:{blocks:{languageVersion:0,blocks:[]}}
    });
    if(lesson && lesson.workspace) lesson.workspace.clear();

    /* ---------- Correct Setup JSON ---------- */
    const VAR_SECRET="VAR_SECRET_ID";
    const VAR_GUESS="VAR_GUESS_ID";
    const numShadow=(n)=>({shadow:{type:"math_number",fields:{NUM:n}}});

    const solutionJson={
      variables:[
        {name:"SecretNumber",id:VAR_SECRET},
        {name:"Guess",id:VAR_GUESS}
      ],
      blocks:{
        languageVersion:0,
        blocks:[
          {
            type:"on_start",
            x:20,y:20,
            inputs:{
              DO:{
                block:{
                  type:"show_text",fields:{TEXT:"Hello"},
                  next:{
                    block:{
                      type:"pause_block",fields:{MS:2000},
                      next:{
                        block:{
                          type:"variables_set",fields:{VAR:{id:VAR_GUESS,name:"Guess"}},
                          inputs:{VALUE:numShadow(0)},
                          next:{
                            block:{
                              type:"variables_set",fields:{VAR:{id:VAR_SECRET,name:"SecretNumber"}},
                              inputs:{
                                VALUE:{
                                  block:{
                                    type:"math_random_int",
                                    inputs:{
                                      FROM:numShadow(1),
                                      TO:numShadow(5)
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          {
            type:"on_button_pressed",fields:{BTN:"A"},x:20,y:260,
            inputs:{
              DO:{
                block:{
                  type:"variables_change",
                  fields:{VAR:{id:VAR_GUESS,name:"Guess"},DELTA:1},
                  next:{
                    block:{
                      type:"show_number",
                      inputs:{NUM:{block:{type:"variables_get",fields:{VAR:{id:VAR_GUESS,name:"Guess"}}}}}
                    }
                  }
                }
              }
            }
          },
          {
            type:"on_button_pressed",fields:{BTN:"B"},x:260,y:260,
            inputs:{
              DO:{
                block:{
                  type:"variables_change",
                  fields:{VAR:{id:VAR_GUESS,name:"Guess"},DELTA:-1},
                  next:{
                    block:{
                      type:"show_number",
                      inputs:{NUM:{block:{type:"variables_get",fields:{VAR:{id:VAR_GUESS,name:"Guess"}}}}}
                    }
                  }
                }
              }
            }
          },
          {
            type:"on_shake",x:20,y:460,
            inputs:{
              DO:{
                block:{
                  type:"controls_if",
                  extraState:{elseIfCount:0,hasElse:true},
                  inputs:{
                    IF0:{
                      block:{
                        type:"logic_compare",fields:{OP:"EQ"},
                        inputs:{
                          A:{block:{type:"variables_get",fields:{VAR:{id:VAR_GUESS,name:"Guess"}}}},
                          B:{block:{type:"variables_get",fields:{VAR:{id:VAR_SECRET,name:"SecretNumber"}}}}
                        }
                      }
                    },
                    DO0:{
                      block:{
                        type:"show_text",fields:{TEXT:"yes"},
                        next:{
                          block:{
                            type:"pause_block",fields:{MS:1000},
                            next:{block:{type:"show_icon",fields:{ICON:"heart"}}}
                          }
                        }
                      }
                    },
                    ELSE:{
                      block:{
                        type:"show_text",fields:{TEXT:"Try Again"},
                        next:{
                          block:{
                            type:"show_icon",fields:{ICON:"square_border"},
                            next:{block:{type:"pause_block",fields:{MS:1000}}}
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        ]
      }
    };
    window.solutionJson=solutionJson;

    /* ---------- Sidebar Slides ---------- */
    const stepCards=[

`<h3 style="text-align:center;color:#1e3a8a;">Step 1 ‚Äî Generate a Random Secret Number</h3>
<div class="callout">
  üé≤ From the <strong>Math</strong> tab, drag <strong>pick random 1 to 5</strong>.<br>
  üî¢ From <strong>Math</strong>, drag two <strong>number</strong> blocks and snap them into the <em>pick random</em> block to set <code>1</code> and <code>5</code>.<br>
  üß© From <strong>Variables</strong>, click <strong>Make a Variable</strong> and name it <em>SecretNumber</em>.<br>
  üöÄ From <strong>Basic</strong>, drag <strong>on start</strong> to the Workspace.<br>
  üí¨ Inside it, add <strong>show text "Hello"</strong> and <strong>pause (ms) 2000</strong>.<br>
  üß© From <strong>Variables</strong>, drag <strong>set SecretNumber to</strong> and snap the <em>pick random 1 to 5</em> block inside.<br>
  ‚ñ∂Ô∏è Click <strong>Run</strong> to see the message and set the number.<br>
  üí¨ Liam: ‚ÄúMy secret visual code is ready!‚Äù
</div>`,

`<h3 style="text-align:center;color:#1e3a8a;">Step 2 ‚Äî Set Up a Guess Variable</h3>
<div class="callout">
  üß© From <strong>Variables</strong>, click <strong>Make a Variable</strong> and name it <em>Guess</em>.<br>
  üî¢ Inside the same <em>on start</em>, add <strong>set Guess to 0</strong> (from Variables + Math).<br>
  ‚ñ∂Ô∏è Click <strong>Run</strong> to test.<br>
  üí¨ Liam: ‚ÄúLet‚Äôs track your guess!‚Äù
</div>`,

`<h3 style="text-align:center;color:#1e3a8a;">Step 3 ‚Äî Add Button Inputs for Guessing</h3>
<div class="callout">
  üîò From <strong>Input</strong>, drag <strong>on button A pressed</strong>.<br>
  ‚ûï Inside it, add <strong>change Guess by 1</strong> (from Variables).<br>
  üî¢ Add <strong>show number Guess</strong> (from Basic + Variables).<br><br>
  üîò From <strong>Input</strong>, drag <strong>on button B pressed</strong>.<br>
  ‚ûñ Inside it, add <strong>change Guess by -1</strong> (from Variables) and <strong>show number Guess</strong>.<br>
  ‚ñ∂Ô∏è Click <strong>Run</strong>, press A/B to adjust Guess.<br>
  üí¨ Liam: ‚ÄúPress A to go up, B to go down!‚Äù
</div>`,

`<h3 style="text-align:center;color:#1e3a8a;">Step 4 ‚Äî Check the Guess and Give Visual Feedback</h3>
<div class="callout">
  üì≥ From <strong>Input</strong>, drag <strong>on shake</strong>.<br>
  ‚öôÔ∏è Inside it, add <strong>if then else</strong> (from Logic).<br>
  üí≠ Condition: <em>Guess = SecretNumber</em> (Variables + Logic).<br>
  ‚úÖ In ‚Äúthen‚Äù: add <strong>show text "yes"</strong> ‚Üí <strong>pause (ms) 1000</strong> ‚Üí <strong>show icon heart</strong>.<br>
  ‚ùå In ‚Äúelse‚Äù: add <strong>show text "Try Again"</strong> ‚Üí <strong>show icon square (border)</strong> ‚Üí <strong>pause (ms) 1000</strong>.<br>
  ‚ñ∂Ô∏è Click <strong>Run</strong>, adjust Guess, shake to submit.<br>
  üí¨ Liam: ‚ÄúGuess my code and shake to see the lights!‚Äù
</div>`,

`<div class="callout" style="text-align:center;">
  <button class="gb-btn cta" id="open-solution">‚úÖ Check Your Setup</button>
</div>`,

`<h3 style="text-align:center;color:#00A1D6;">Did You Know?</h3>
<div class="callout">
  üí° Video games use light signals to reward players ‚Äî GlowBit does the same!<br>
  üö¶ Traffic lights and elevators flash colors to guide people safely.<br>
  ü§ñ Robots use LED patterns to communicate status ‚Äî you‚Äôre learning that concept now!
</div>
<div class="callout">
  <span class="tip">Try this</span> Change the range to <code>1‚Äì10</code> or use different icons to show hint levels.
</div>`
    ];

    /* ---------- Pagination ---------- */
    function paginate(){
      const sidebar=document.querySelector('#glowbit-project11A .glowbit-left');
      if(!sidebar)return;
      const editor=document.getElementById('glowbit-project11A-editor');
      const targetH=(editor&&editor.offsetHeight)?editor.offsetHeight:520;
      const meas=document.createElement('div');
      meas.style.visibility='hidden';meas.style.position='absolute';meas.style.left='-9999px';
      meas.style.width=(sidebar.clientWidth||320)+'px';document.body.appendChild(meas);
      const pages=[];let current=[];const reserve=56;
      stepCards.forEach(html=>{
        const c=document.createElement('div');c.innerHTML=html;meas.appendChild(c);
        const tooTall=meas.scrollHeight>(targetH-reserve);
        if(tooTall){
          if(current.length===0){pages.push([html]);meas.innerHTML='';}
          else{pages.push([...current]);current=[html];meas.innerHTML='';
            current.forEach(h=>{const d=document.createElement('div');d.innerHTML=h;meas.appendChild(d);});}
        }else current.push(html);
      });
      if(current.length)pages.push(current);
      document.body.removeChild(meas);
      function render(i){
        sidebar.innerHTML=pages[i].join('');
        const nav=document.createElement('div');nav.className='nav-btns';
        if(i>0){const b=document.createElement('button');b.textContent='‚¨Ö Back';b.className='gb-btn back';b.onclick=()=>render(i-1);nav.appendChild(b);}
        if(i<pages.length-1){const n=document.createElement('button');n.textContent='Next ‚ûú';n.className='gb-btn next';n.onclick=()=>render(i+1);nav.appendChild(n);}
        sidebar.appendChild(nav);
        const frame=document.createElement('div');frame.className='character-frame';
        frame.innerHTML='<img src="images/GlowBit3.png" alt="GlowBit buddy">';
        sidebar.appendChild(frame);
        const openBtn=document.getElementById('open-solution');
        if(openBtn)openBtn.addEventListener('click',()=>showSolutionModal());
      }
      render(0);
    }
    paginate();
    window.addEventListener('resize',()=>{paginate();if(lesson&&lesson.workspace)Blockly.svgResize(lesson.workspace);});

    /* ---------- Modal ---------- */
    const modal=document.getElementById('solutionModalP11A');
    const wsDiv=document.getElementById('solutionWorkspaceP11A');
    const closeBtns=[document.getElementById('solutionCloseP11A'),document.getElementById('solutionCloseBtnP11A')];
    function showSolutionModal(){
      modal.style.display='block';wsDiv.innerHTML='';
      const ws=Blockly.inject(wsDiv,{readOnly:true,scrollbars:true});
      Blockly.serialization.workspaces.load(window.solutionJson,ws);
    }
    closeBtns.forEach(b=>b.addEventListener('click',()=>modal.style.display='none'));

    console.log('‚úÖ Project 11A ‚Äì Liam‚Äôs Visual Guessing Challenge (corrected with square border + explicit tab instructions).');
  })();
  </script>
</body>
</html>
