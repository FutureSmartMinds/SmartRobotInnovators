<script>
console.log("üî• Step1 script tag detected by browser.");

window.addEventListener('DOMContentLoaded', function () {
  console.log("‚úÖ DOMContentLoaded fired.");

  // Verify that our target container exists in the DOM
  const container = document.getElementById('glowbit-step1');
  if (!container) {
    console.error("‚ùå #glowbit-step1 not found in DOM. Blockly cannot render.");
    return;
  } else {
    console.log("‚úÖ Found #glowbit-step1 container in DOM.");
  }

  (function waitForGlow() {
    if (window.Glowbit && window.Blockly) {
      console.log("‚úÖ Glowbit & Blockly available.");

      try {
        const testXml = `
          <xml xmlns="https://developers.google.com/blockly/xml">
            <block type="math_number">
              <field name="NUM">42</field>
            </block>
          </xml>
        `;

        const lesson = Glowbit.createLessonUI('glowbit-step1', {
          title: 'Blockly Test',
          instructions: 'This is a Blockly test block.',
          pixelSize: 28,
          defaultXml: testXml
        });

        console.log("‚úÖ Blockly UI created successfully.");
        window._lesson_step1 = lesson;

        // Verify SVG render
        setTimeout(() => {
          const svg = document.querySelector("svg.blocklySvg");
          if (svg) {
            console.log("‚úÖ Blockly SVG found in DOM (rendered).");
          } else {
            console.warn("‚ö†Ô∏è Blockly SVG NOT found. Rendering may have failed.");
          }
        }, 500);

      } catch (e) {
        console.error("‚ùå Error during Blockly UI creation:", e);
      }
    } else {
      console.log("‚åõ Waiting for Glowbit or Blockly...");
      setTimeout(waitForGlow, 250);
    }
  })();
});
</script>

